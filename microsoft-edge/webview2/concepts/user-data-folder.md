---
description: Découvrez comment gérer les dossiers de données utilisateur dans les applications WebView2
title: Gérer le dossier de données utilisateur dans les applications WebView2.
author: MSEdgeTeam
ms.author: msedgedevrel
ms.date: 05/06/2021
ms.topic: conceptual
ms.prod: microsoft-edge
ms.technology: webview
keywords: IWebView2, IWebView2WebView, webview2, webview, win32 apps, win32, edge, ICoreWebView2, ICoreWebView2Host, browser control, edge html, user data folder
ms.openlocfilehash: d3b3e8d81ddffec043f0988385a433eb7c817de7
ms.sourcegitcommit: 5ae09b1ad6cd576c9fec12538b23cd849861f2b2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/01/2021
ms.locfileid: "11627956"
---
# <a name="manage-the-user-data-folder"></a><span data-ttu-id="07997-104">Gérer le dossier de données utilisateur</span><span class="sxs-lookup"><span data-stu-id="07997-104">Manage the user data folder</span></span>  

<span data-ttu-id="07997-105">Les applications WebView2 interagissent avec les dossiers de données utilisateur pour stocker les données du navigateur, telles que les cookies, les autorisations et les ressources mises en cache.</span><span class="sxs-lookup"><span data-stu-id="07997-105">WebView2 applications interact with user data folders to store browser data, such as cookies, permissions, and cached resources.</span></span>  <span data-ttu-id="07997-106">Chaque instance d’un contrôle WebView2 est associée à un dossier de données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="07997-106">Each instance of a WebView2 control is associated with a user data folder.</span></span>  <span data-ttu-id="07997-107">Chaque dossier de données utilisateur est propre à un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="07997-107">Each user data folder is unique to a user.</span></span>  

## <a name="best-practices"></a><span data-ttu-id="07997-108">Meilleures pratiques</span><span class="sxs-lookup"><span data-stu-id="07997-108">Best practices</span></span>  

<span data-ttu-id="07997-109">Les dossiers de données utilisateur sont créés automatiquement par WebView2.</span><span class="sxs-lookup"><span data-stu-id="07997-109">User data folders are created automatically by WebView2.</span></span>  <span data-ttu-id="07997-110">Les développeurs WebView2 contrôlent la durée de vie du dossier de données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="07997-110">WebView2 developers control the lifetime of the user data folder.</span></span>  <span data-ttu-id="07997-111">Si votre application ré-utilise les données utilisateur des sessions d’application, envisagez d’enregistrer les dossiers de données utilisateur, sinon vous pouvez les supprimer.</span><span class="sxs-lookup"><span data-stu-id="07997-111">If your application re-uses user data from application sessions, consider saving the user data folders, otherwise you may delete them.</span></span>  <span data-ttu-id="07997-112">Prenons les scénarios suivants lorsque vous décidez comment gérer vos dossiers de données utilisateur :</span><span class="sxs-lookup"><span data-stu-id="07997-112">Consider the following scenarios when deciding how to manage your user data folders:</span></span>  

*   <span data-ttu-id="07997-113">Si le même utilisateur utilise votre application à plusieurs reprises et que le contenu web de l’application s’appuie sur les données de l’utilisateur, enregistrez le dossier de données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="07997-113">If the same user uses your application repeatedly, and the web content of the application relies on the user's data, save the user data folder.</span></span>  <span data-ttu-id="07997-114">Si plusieurs utilisateurs utilisent votre application à plusieurs reprises, créez un dossier de données utilisateur pour chaque nouvel utilisateur et enregistrez le dossier de données utilisateur de chaque utilisateur.</span><span class="sxs-lookup"><span data-stu-id="07997-114">If multiple users use your application repeatedly, create a new user data folder for each new user, and save the user data folder of each user.</span></span>
*   <span data-ttu-id="07997-115">Si votre application ne contient pas d’utilisateurs répétés, créez un dossier de données utilisateur pour chaque utilisateur et supprimez le dossier de données utilisateur précédent.</span><span class="sxs-lookup"><span data-stu-id="07997-115">If your application does not have repeat users, create a new user data folder for each user, and delete the previous user data folder.</span></span>  
    
## <a name="create-user-data-folders"></a><span data-ttu-id="07997-116">Créer des dossiers de données utilisateur</span><span class="sxs-lookup"><span data-stu-id="07997-116">Create user data folders</span></span>  

<span data-ttu-id="07997-117">Pour spécifier l’emplacement du dossier de données utilisateur, incluez le paramètre lorsque vous appelez `userDataFolder` [ICoreWebView2Environment](/microsoft-edge/webview2/reference/win32/icorewebview2environment) \(Win32\) ou [CoreWebView2Environment](/dotnet/api/microsoft.web.webview2.core.corewebview2environment) \(.NET\).</span><span class="sxs-lookup"><span data-stu-id="07997-117">To specify the location of the user data folder, include the `userDataFolder` parameter when calling [ICoreWebView2Environment](/microsoft-edge/webview2/reference/win32/icorewebview2environment) \(Win32\) or [CoreWebView2Environment](/dotnet/api/microsoft.web.webview2.core.corewebview2environment) \(.NET\).</span></span>  <span data-ttu-id="07997-118">Après la création, les données de navigateur de votre contrôle WebView2 sont stockées dans un sous-foldeur de `userDataFolder` .</span><span class="sxs-lookup"><span data-stu-id="07997-118">After creation, browser data from your WebView2 control is stored in a subfolder of `userDataFolder`.</span></span>  <span data-ttu-id="07997-119">`userDataFolder`Lorsqu’il n’est pas spécifié, WebView2 crée des dossiers de données utilisateur aux emplacements par défaut comme suit :</span><span class="sxs-lookup"><span data-stu-id="07997-119">When `userDataFolder` is not specified, WebView2 creates user data folders at default locations as follows:</span></span>  

*   <span data-ttu-id="07997-120">Pour les Windows du Windows Store, le dossier utilisateur par défaut est le sous-dossier du `ApplicationData\LocalFolder` dossier du package.</span><span class="sxs-lookup"><span data-stu-id="07997-120">For packaged Windows Store apps, the default user folder is the `ApplicationData\LocalFolder` subfolder in the package's  folder.</span></span>  
*   <span data-ttu-id="07997-121">Pour les applications de bureau existantes, le dossier de données utilisateur par défaut est le chemin d’accès exe de votre application + `.WebView2` .</span><span class="sxs-lookup"><span data-stu-id="07997-121">For existing desktop apps, the default user data folder is the exe path of your application + `.WebView2`.</span></span>  <span data-ttu-id="07997-122">Au lieu d’utiliser la valeur par défaut, nous vous recommandons de spécifier un dossier de données utilisateur et de le créer dans le même dossier où sont stockées toutes les autres données d’application.</span><span class="sxs-lookup"><span data-stu-id="07997-122">Instead of using the default, we recommend that you specify a user data folder, and that you create it in the same folder where all other app data is stored.</span></span>  
    
## <a name="delete-user-data-folders"></a><span data-ttu-id="07997-123">Supprimer des dossiers de données utilisateur</span><span class="sxs-lookup"><span data-stu-id="07997-123">Delete user data folders</span></span>  

<span data-ttu-id="07997-124">Votre application devra peut-être supprimer des dossiers de données utilisateur :</span><span class="sxs-lookup"><span data-stu-id="07997-124">Your application may need to delete user data folders:</span></span>  

*   <span data-ttu-id="07997-125">Lors de la désinstallation de votre application.</span><span class="sxs-lookup"><span data-stu-id="07997-125">When uninstalling your app.</span></span>  <span data-ttu-id="07997-126">Si vous désinstallez des applications empaquetées Windows store, Windows supprime automatiquement les dossiers de données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="07997-126">If you are uninstalling packaged Windows Store apps, Windows deletes user data folders automatically.</span></span>  
*   <span data-ttu-id="07997-127">Pour nettoyer tout l’historique des données de navigation.</span><span class="sxs-lookup"><span data-stu-id="07997-127">To clean up all browsing data history.</span></span>  
*   <span data-ttu-id="07997-128">Pour récupérer à partir d’une altération des données.</span><span class="sxs-lookup"><span data-stu-id="07997-128">To recover from data corruption.</span></span>  
*   <span data-ttu-id="07997-129">Pour supprimer les données de session précédentes.</span><span class="sxs-lookup"><span data-stu-id="07997-129">To remove previous session data.</span></span>  
    
> [!NOTE]
> <span data-ttu-id="07997-130">Les fichiers des dossiers de données utilisateur peuvent toujours être utilisés après la fermeture de l’application WebView2.</span><span class="sxs-lookup"><span data-stu-id="07997-130">Files in user data folders may still be in use after the WebView2 application is closed.</span></span>  <span data-ttu-id="07997-131">Dans ce cas, attendez que le processus du navigateur et tous les processus enfants se quittent avant de supprimer le dossier.</span><span class="sxs-lookup"><span data-stu-id="07997-131">In this situation, wait for the browser process and all child processes to exit before deleting the folder.</span></span>  <span data-ttu-id="07997-132">Vous pouvez récupérer l’ID de processus du processus de navigateur à l’aide de la `BrowserProcessId` propriété webView2.</span><span class="sxs-lookup"><span data-stu-id="07997-132">You may retrieve the process id of the browser process using the `BrowserProcessId` property of the WebView2.</span></span>  

## <a name="share-user-data-folders"></a><span data-ttu-id="07997-133">Partager des dossiers de données utilisateur</span><span class="sxs-lookup"><span data-stu-id="07997-133">Share user data folders</span></span>  

<span data-ttu-id="07997-134">Les contrôles WebView2 peuvent partager les mêmes dossiers de données utilisateur pour :</span><span class="sxs-lookup"><span data-stu-id="07997-134">WebView2 controls may share the same user data folders to:</span></span>  

*   <span data-ttu-id="07997-135">[Optimisez les ressources système](../concepts/process-model.md) en l’exécutant dans un processus de navigateur.</span><span class="sxs-lookup"><span data-stu-id="07997-135">[Optimize system resources](../concepts/process-model.md) by running in one browser process.</span></span>  
*   <span data-ttu-id="07997-136">Partagez l’historique du navigateur et les ressources mises en cache.</span><span class="sxs-lookup"><span data-stu-id="07997-136">Share browser history and cached resources.</span></span>  
    
<span data-ttu-id="07997-137">Prenons les considérations suivantes lors du partage de dossiers de données utilisateur :</span><span class="sxs-lookup"><span data-stu-id="07997-137">Consider the following when sharing user data folders:</span></span>  

1.  <span data-ttu-id="07997-138">Lorsque vous re-créez des contrôles WebView2 pour mettre à jour les versions du navigateur à l’aide d’événements [add_NewBrowserVersionAvailable](/microsoft-edge/webview2/reference/win32/icorewebview2environment#add_newbrowserversionavailable) \(Win32\) ou [NewBrowserVersionAvailable](/dotnet/api/microsoft.web.webview2.core.corewebview2environment.newbrowserversionavailable) \(.NET\), assurez-vous que les processus de navigateur quittent et ferment les contrôles WebView2 qui partagent le même dossier de données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="07997-138">When re-creating WebView2 controls to update browser versions using [add_NewBrowserVersionAvailable](/microsoft-edge/webview2/reference/win32/icorewebview2environment#add_newbrowserversionavailable) \(Win32\) or [NewBrowserVersionAvailable](/dotnet/api/microsoft.web.webview2.core.corewebview2environment.newbrowserversionavailable) \(.NET\) events, ensure browser processes exit and close WebView2 controls that share the same user data folder.</span></span>  <span data-ttu-id="07997-139">Pour récupérer l’ID de processus du processus de navigateur, utilisez la `BrowserProcessId` propriété du contrôle WebView2.</span><span class="sxs-lookup"><span data-stu-id="07997-139">To retrieve the process id of the browser process, use the `BrowserProcessId` property of the WebView2 control.</span></span>  
1.  <span data-ttu-id="07997-140">Les contrôles WebView2 qui partagent le même dossier de données utilisateur doivent utiliser les mêmes options pour [ICoreWebView2Environment](/microsoft-edge/webview2/reference/win32/icorewebview2environment) \(Win32\) ou [CoreWebView2Environment](/dotnet/api/microsoft.web.webview2.core.corewebview2environment) \(.NET\).</span><span class="sxs-lookup"><span data-stu-id="07997-140">WebView2 controls that share the same user data folder must use the same options for [ICoreWebView2Environment](/microsoft-edge/webview2/reference/win32/icorewebview2environment) \(Win32\) or [CoreWebView2Environment](/dotnet/api/microsoft.web.webview2.core.corewebview2environment) \(.NET\).</span></span>  <span data-ttu-id="07997-141">Si ce n’est pas le cas, la création de WebView2 échouera avec `HRESULT_FROM_WIN32(ERROR_INVALID_STATE)` .</span><span class="sxs-lookup"><span data-stu-id="07997-141">If not, the WebView2 creation will fail with `HRESULT_FROM_WIN32(ERROR_INVALID_STATE)`.</span></span>  
    
<span data-ttu-id="07997-142">Pour isoler différentes parties de votre application ou lorsque le partage de données entre les contrôles WebView2 n’est pas nécessaire, vous pouvez choisir d’utiliser différents dossiers de données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="07997-142">To isolate different parts of your application or when sharing data between WebView2 controls is not needed, you may choose to use different user data folders.</span></span>  <span data-ttu-id="07997-143">Par exemple, une application peut se composer de deux contrôles WebView2, l’un pour l’affichage d’une annonce et l’autre pour l’affichage du contenu de l’application.</span><span class="sxs-lookup"><span data-stu-id="07997-143">For example, an application may consist of two WebView2 controls, one for displaying an advertisement and the other for displaying application content.</span></span>  <span data-ttu-id="07997-144">Dans ce scénario, les développeurs peuvent choisir d’utiliser différents dossiers de données utilisateur pour chaque contrôle WebView2.</span><span class="sxs-lookup"><span data-stu-id="07997-144">In this scenario, developers may opt to use different user data folders for each WebView2 control.</span></span>  

> [!NOTE]
> <span data-ttu-id="07997-145">Chaque processus de navigateur WebView2 consomme de la mémoire et de l’espace disque supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="07997-145">Each WebView2 browser process consumes additional memory and disk space.</span></span>  <span data-ttu-id="07997-146">Par conséquent, nous vous recommandons de ne pas l’exécution de WebView2s avec un trop grand nombre de dossiers de données utilisateur différents en même temps.</span><span class="sxs-lookup"><span data-stu-id="07997-146">Therefore, we recommend not running WebView2s with too many different user data folders at the same time.</span></span>  
